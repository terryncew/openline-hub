<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>OpenLine Hub ¬∑ Portable Proof for AI</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Live receipts and researcher kit for OpenLine ¬∑ COLE. Proof moves; data doesn‚Äôt." />
  <meta property="og:title" content="OpenLine Hub ¬∑ Portable Proof for AI" />
  <meta property="og:description" content="Live receipts, demos, and researcher kit. Proof moves; data doesn't." />
  <meta property="og:image" content="https://terryncew.github.io/openline-hub/og-image.png" />
  <meta property="og:url" content="https://terryncew.github.io/openline-hub/" />
  <meta name="twitter:card" content="summary_large_image" />
  <style>
    :root{--bg:#0f1115;--ink:#e9eef7;--muted:#9aa4b2;--tile:#151821;--line:#232838;
      --ok:#16a34a;--warn:#f59e0b;--bad:#ef4444}
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--ink);
      font:15px/1.5 -apple-system,system-ui,Segoe UI,Inter,Helvetica,Arial}
    a{color:inherit;text-decoration:none}
    code,kbd{font:12px ui-monospace,Menlo,Consolas,monospace;background:#0b0d12;border:1px solid #1c2130;border-radius:6px;padding:2px 6px}
    .wrap{max-width:980px;margin:0 auto;padding:20px}
    header{display:flex;justify-content:space-between;align-items:center;margin:6px 0 10px}
    .brand{font-weight:700;letter-spacing:.2px}
    .badge{display:inline-block;padding:6px 10px;border:1px solid var(--line);border-radius:999px;color:var(--muted)}
    .hero{margin:12px 0 18px;padding:16px;border:1px solid var(--line);border-radius:14px;background:linear-gradient(180deg,#121522,#0f1115)}
    .hero h1{margin:0 0 6px;font-size:22px}
    .hero p{margin:0;color:var(--muted)}
    .inline{display:flex;gap:8px;flex-wrap:wrap}
    .btn{display:inline-block;padding:10px 14px;border-radius:10px;border:1px solid var(--ink);font-weight:600}
    .btn.secondary{border-color:var(--line)}
    .section{margin:20px 0}
    .panel{padding:14px;border:1px solid var(--line);border-radius:12px;background:var(--tile)}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px}
    .tile{position:relative;padding:14px;border:1px solid var(--line);border-radius:12px;background:var(--tile)}
    .tile h3{margin:0 0 8px;font-size:16px}
    .muted{color:var(--muted)}
    .note{font-size:12px;color:var(--muted)}
    .chip{display:inline-flex;align-items:center;gap:6px;font-size:11px;padding:4px 10px;border:1px solid var(--line);border-radius:999px;color:var(--ink)}
    .chip.ok{background:#0f1a12;border-color:#173224}
    .chip.warn{background:#1e180a;border-color:#3d2e0a}
    .chip.bad{background:#1e0c0f;border-color:#3a1118}
    .chip.neutral{background:#0b0d12;border-color:#1c2130;color:#c9d2e3}
    .card{margin-top:10px;border:1px solid var(--line);border-radius:12px;background:#10131b}
    .row{display:grid;grid-template-columns:90px 1fr;border-top:1px solid #20263a;padding:12px 14px}
    .row:first-child{border-top:none;border-top-left-radius:12px;border-top-right-radius:12px}
    .row:last-child{border-bottom-left-radius:12px;border-bottom-right-radius:12px}
    .left{letter-spacing:.3px;color:#a8b2c3;font-weight:600}
    .right{white-space:pre-wrap}
    @media (max-width:420px){.btn{padding:9px 12px}.hero h1{font-size:20px}}
  </style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="brand">OpenLine Hub</div>
    <div class="badge">Portable proof ¬∑ vendor-neutral</div>
  </header>

  <div class="hero">
    <h1>Proof moves; data doesn‚Äôt.</h1>
    <p>Uniform cards from any receipt family. Triage, not truth.</p>
    <div class="inline" style="margin-top:10px">
      <a class="btn" href="https://zenodo.org/records/17487669" target="_blank" rel="noopener">Coherence Dynamics v1.2 (Erratum)</a>
      <a class="btn secondary" href="https://github.com/terryncew/openline-core" target="_blank" rel="noopener">GitHub ¬∑ openline-core</a>
    </div>
  </div>

  <!-- FEATURED -->
  <div class="section">
    <h2 style="margin:0 0 10px">Featured receipt</h2>
    <div id="featured" class="tile"><div class="note">Loading‚Ä¶</div></div>
  </div>

  <!-- REMOTE SKUs -->
  <div class="section">
    <h2 style="margin:0 0 8px">SKU gallery (uniform view)</h2>
    <div id="skuGrid" class="grid" aria-live="polite"></div>
  </div>

  <!-- LOCAL (optional) -->
  <div class="section">
    <h2 style="margin:0 0 8px">Local receipts (reads <code>docs/receipts/manifest.json</code>)</h2>
    <div id="rxGrid" class="grid" aria-live="polite"></div>
  </div>

  <!-- KIT -->
  <div class="section">
    <h2 style="margin:0 0 8px">Researcher kit</h2>
    <div class="panel">
      <p class="muted">Validate any receipt URL or copy a tiny template.</p>
      <div class="inline" style="margin-top:6px">
        <input id="valUrl" type="text" placeholder="https://raw.githubusercontent.com/.../docs/receipt.latest.json" style="flex:1;min-width:220px">
        <button class="btn" id="valBtn" type="button">Validate</button>
        <button class="btn secondary" type="button" id="copyTpl">Copy Template</button>
      </div>
      <pre id="valOut" class="note" style="white-space:pre-wrap;margin-top:8px"></pre>
    </div>
  </div>

  <!-- OFFER -->
  <div class="section">
    <h2 style="margin:0 0 8px">Exclusive</h2>
    <div class="grid">
      <a class="tile" href="./exclusive.html">
        <h3>Field-of-Use Exclusivity (12 months)</h3>
        <p class="muted">From $30M base + performance kicker. Non-exclusive eval $12M.</p>
        <div class="note">KPIs: ROAS +1.5% ¬∑ Energy ‚àí2% ¬∑ Integrity lead ‚â•14 d</div>
      </a>
      <a class="tile" href="https://terryncew.github.io/openline-exchange/?utm_source=openline-hub" target="_blank" rel="noopener">
        <h3>OpenLine Exchange</h3>
        <p class="muted">List offers with preview receipts and rights-in-file.</p>
        <div class="note">Offers ¬∑ Receipts-native</div>
      </a>
    </div>
  </div>

  <footer class="section" style="margin-bottom:30px">
    <div class="muted">OpenLine ¬∑ COLE ¬∑ MIT. ¬© Sir Terrynce.</div>
  </footer>
</div>

<script>
/* ------------------------ NORMALIZER (first principles) ------------------------ */
/* Finds first non-empty value among many dotted paths (case-insensitive) */
function pick(obj, paths, fallback=''){
  for(const p of paths){
    const parts = p.split('.'); let cur = obj;
    for(const raw of parts){
      if(!cur) { cur = undefined; break; }
      // case-insensitive key search at each level
      const key = Object.keys(cur).find(k=>k.toLowerCase()===raw.toLowerCase());
      cur = key ? cur[key] : undefined;
    }
    if(cur!==undefined && cur!==null && cur!=='') return cur;
  }
  return fallback;
}

/* Map a raw receipt to a uniform view */
function normalize(j={}, sourceUrl=''){
  const version = String(pick(j, ['version','receipt_version','olr','olr_version'],'')).toLowerCase();
  const statusRaw = String(pick(j, [
    'attrs.status','badge.status','status','labels.status','health.status'
  ], '')).toLowerCase();

  const fam = pick(j, ['model.family','model.name','model.id','model','engine'],'demo-llm');
  const issued = pick(j, ['issued_at','run.ts','run.time','timestamp','ts'],'');
  const p = pick(j, ['point','claims.point','CLAIMS.POINT'],'‚Äî');
  const bcz = pick(j, ['because','claims.because'],'‚Äî');
  const but = pick(j, ['but','claims.but'],'‚Äî');
  const so = pick(j, ['so','claims.so'],'‚Äî');

  const train = String(pick(j, ['precision.train_dtype','precision.train','dtype.train','dtype'],'')).toLowerCase();
  const infer = String(pick(j, ['precision.infer_dtype','precision.infer','infer_dtype'],'')).toLowerCase();
  const dtypes = (train||infer) ? `${train||infer}/${infer||train||'‚Äî'}` : '‚Äî';

  const kappa = pick(j, ['health.kappa','metrics.kappa','kappa','Œ∫'],'');
  const drift = pick(j, ['health.delta_hol','health.drift','metrics.delta_hol','Œîhol','deltaHol','drift'],'');
  const fresh = pick(j, ['health.freshness_ratio','metrics.freshness_ratio','freshness','freshness_ratio'],'');
  const sku = version.includes('1.5') ? 'OLR/1.5-P'
           : version.includes('1.4') ? 'OLR/1.4L'
           : (version ? version.toUpperCase() : '‚Äî');

  const status = ['green','ok','clean','coherent'].includes(statusRaw) ? 'CLEAN'
               : ['amber','warn','check','yellow'].includes(statusRaw)   ? 'CHECK'
               : ['red','risk','bad'].includes(statusRaw)                ? 'RISK'
               : '‚Äî';

  return {sku, status, fam, issued, p,bcz,but,so, dtypes, kappa, drift, fresh, src:sourceUrl};
}

/* UI helpers */
const el=(t,c,txt)=>{const e=document.createElement(t); if(c) e.className=c; if(txt!==undefined) e.textContent=txt; return e;};
function chip(status){
  const map = {CLEAN:'ok', CHECK:'warn', RISK:'bad', '‚Äî':'neutral'};
  const cls = map[status] || 'neutral';
  const s = el('span',`chip ${cls}`,status);
  return s;
}
function metricsRow(kappa, drift, fresh){
  const wrap = el('div','inline'); wrap.style.gap='8px'; wrap.style.flexWrap='wrap';
  const mk = (label,val)=>{ const c=el('span','chip neutral', `${label} ${val!==''?val:'‚Äî'}`); return c; };
  wrap.appendChild(mk('Œ∫', kappa));
  wrap.appendChild(mk('Œîhol', drift));
  wrap.appendChild(mk('fresh', fresh));
  return wrap;
}
function card(title, view){
  const t = el('div','tile');
  const top = el('div','inline'); top.style.justifyContent='space-between'; top.style.alignItems='center';
  const h = el('div'); h.appendChild(el('h3','',title)); h.appendChild(el('div','muted',view.issued));
  const r = el('div'); r.style.display='flex'; r.style.gap='8px'; r.appendChild(chip(view.status));
  r.appendChild(el('span','chip neutral', view.sku));
  top.appendChild(h); top.appendChild(r);

  const c = el('div','card');
  const row=(k,v)=>{const rr=el('div','row'); rr.appendChild(el('div','left',k)); rr.appendChild(el('div','right',v||'‚Äî')); return rr;};
  c.appendChild(row('MODEL', `${view.fam} ¬∑ ${view.dtypes}`));
  c.appendChild(row('POINT', view.p));
  c.appendChild(row('BECAUSE', view.bcz));
  c.appendChild(row('BUT', view.but));
  c.appendChild(row('SO', view.so));
  c.appendChild(el('div','row')); // spacer
  c.lastChild.style.display='none';
  const mbox = el('div'); mbox.style.padding='10px 14px'; mbox.appendChild(metricsRow(view.kappa,view.drift,view.fresh)); c.appendChild(mbox);

  const src = el('div','note','source: '+view.src);

  t.appendChild(top); t.appendChild(c); t.appendChild(src);
  return t;
}

/* ------------------------ DATA SOURCES ------------------------ */
const RAW = (repo)=>`https://raw.githubusercontent.com/terryncew/${repo}/main/docs/receipt.latest.json`;
const REMOTE = [
  {label:'COLE-Coherence-Layer-Engine', url: RAW('COLE-Coherence-Layer-Engine-')},
  {label:'openline-csm',                 url: RAW('openline-csm')},
  {label:'openline-amber-demo',          url: RAW('openline-amber-demo')},
  {label:'open-receipts',                url: RAW('open-receipts')},
  {label:'terrynce-stack',               url: RAW('terrynce-stack')},
];

/* ------------------------ RENDER ------------------------ */
(async function renderFeatured(){
  const box = document.getElementById('featured');
  try{
    const url = RAW('terrynce-stack');
    const txt = await fetch(url,{cache:'no-store'}).then(r=>r.text());
    const bytes = new TextEncoder().encode(txt).length;
    const j = JSON.parse(txt);
    const view = normalize(j, `${url} ¬∑ bytes=${bytes} ¬∑ version=${(j.version||j.receipt_version||'').toString()}`);
    box.innerHTML=''; box.appendChild(card('terrynce-stack / receipt.latest.json', view));
  }catch(e){ box.innerHTML=''; box.appendChild(el('div','note', 'Featured load failed: '+(e.message||'error'))); }
})();

(async function renderSKU(){
  const grid = document.getElementById('skuGrid');
  for(const r of REMOTE){
    const tile = el('div','tile'); grid.appendChild(tile);
    try{
      const txt = await fetch(r.url,{cache:'no-store'}).then(x=>x.text());
      const bytes = new TextEncoder().encode(txt).length;
      const j = JSON.parse(txt);
      const view = normalize(j, `${r.url} ¬∑ bytes=${bytes} ¬∑ version=${(j.version||j.receipt_version||'').toString()}`);
      const c = card(`${r.label} / receipt.latest.json`, view);
      tile.replaceWith(c);
    }catch(e){
      tile.innerHTML='';
      tile.appendChild(el('div','note',`${r.label}: failed ¬∑ ${e.message||'error'}`));
      tile.appendChild(el('div','note',r.url));
    }
  }
})();

(async function renderLocal(){
  const grid = document.getElementById('rxGrid');
  const root = 'receipts';
  try{
    const m = await fetch(`${root}/manifest.json`,{cache:'no-store'}).then(r=>r.ok?r.json():Promise.reject(new Error('manifest missing')));
    if(!Array.isArray(m.files)||m.files.length===0){ grid.appendChild(el('div','note','No local receipts found. Add files to docs/receipts and list them in manifest.json.')); return; }
    for(const name of m.files){
      const url = `${root}/${name}?v=${Date.now()}`;
      try{
        const txt = await fetch(url,{cache:'no-store'}).then(r=>r.text());
        const bytes = new TextEncoder().encode(txt).length;
        const j = JSON.parse(txt);
        const view = normalize(j, `${url.replace(/\?.*$/,'')} ¬∑ bytes=${bytes} ¬∑ version=${(j.version||j.receipt_version||'').toString()}`);
        grid.appendChild(card(name, view));
      }catch(e){ const t=el('div','tile'); t.appendChild(el('div','note',`Failed to load ${name}: ${e.message||'error'}`)); grid.appendChild(t); }
    }
  }catch(e){ grid.appendChild(el('div','note', e.message||'No manifest')); }
})();

/* ------------------------ VALIDATOR ------------------------ */
document.getElementById('copyTpl')?.addEventListener('click', ()=>{
  const template = {
    receipt_version:"1.5-P",
    version:"OLR/1.5-P",
    issued_at:new Date().toISOString(),
    attrs:{status:"clean"},
    model:{family:"demo-llm"},
    precision:{train_dtype:"fp16",infer_dtype:"fp16"},
    point:"Run fp16/fp16 for speed on commodity GPUs.",
    because:"Œ∫ and Œîhol remain within green bounds on short sequences.",
    but:"Overflow risk rises on very long contexts or mixed-device runs.",
    so:"Ship fp16 for demos; keep a bf16 path for ‚â•4k tokens."
  };
  const txt = JSON.stringify(template,null,2);
  navigator.clipboard.writeText(txt).then(()=>{document.getElementById('valOut').textContent='üìã Template copied';});
});

document.getElementById('valBtn')?.addEventListener('click', async ()=>{
  const out = document.getElementById('valOut');
  const url = (document.getElementById('valUrl').value||'').trim();
  out.textContent='‚Ä¶checking';
  if(!url){ out.textContent='Provide a URL to a JSON receipt.'; return; }
  try{
    const res = await fetch(url,{cache:'no-store'}); if(!res.ok) throw new Error('fetch failed');
    const txt = await res.text(); const bytes = new TextEncoder().encode(txt).length; const j = JSON.parse(txt);
    const v = normalize(j,url);
    const errs = [];
    if(v.status==='‚Äî') errs.push('missing attrs.status / badge.status');
    if(v.sku==='‚Äî') errs.push('missing version / receipt_version');
    out.textContent = errs.length? `‚ùå FAIL\n- ${errs.join('\n- ')}` : `‚úÖ PASS\nbytes=${bytes}, status=${v.status}, sku=${v.sku}`;
  }catch(e){ out.textContent = `‚ùå ${e.message||'Could not fetch/parse JSON'}`; }
});
</script>
</body>
</html>
